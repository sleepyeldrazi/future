if (self.CavalryLogger) { CavalryLogger.start_js(["HdUaA"]); }

__d('RTCScreenSharing',['Promise','FBRTCScreenSharingUtils','RTCUserMediaConstraints','UserAgent','RTCUtils'],(function a(b,c,d,e,f,g){'use strict';var h='screen sharing not supported',i='extension not installed',j='dialog cancel',k='cancelled',l='unexpected error',m={getUserMedia:function r(s){if(c('UserAgent').isBrowser('Firefox')&&navigator.mediaDevices)return c('Promise').resolve(navigator.mediaDevices.getUserMedia(s));if(c('UserAgent').isBrowser('Chrome'))return c('FBRTCScreenSharingUtils').checkExtensionInstalled().then(function(){return n();},function(){return c('Promise').reject(i);}).then(function(t){return c('RTCUtils').getUserMedia(c('RTCUserMediaConstraints').chromeMediaSource(s,t));}).then(function(t){for(var u=t.getTracks(),v=Array.isArray(u),w=0,u=v?u:u[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var x;if(v){if(w>=u.length)break;x=u[w++];}else{w=u.next();if(w.done)break;x=w.value;}var y=x;y.addEventListener('ended',function(z){return setTimeout(function(){if(!t.active)m.stop();});});}return t;});return c('Promise').reject(h);},stop:function r(){return o();},NOT_SUPPORTED_ERROR:h,EXTENSION_NOT_INSTALLED_ERROR:i,DIALOG_CANCEL_ERROR:j,CANCELLED:k,UNEXPECTED_ERROR:l};function n(){return new (c('Promise'))(function(r,s){window.addEventListener('message',t);p('SC_REQUEST');function t(u){var v=u.origin,w=u.data;if(q(v,w))return;window.removeEventListener('message',t);switch(w.type){case 'SC_EXT_INSTALLED':break;case 'SC_DIALOG_SUCCESS':r(w.streamId);break;case 'SC_DIALOG_CANCEL':s(j);break;default:s(l);}}});}function o(){return new (c('Promise'))(function(r,s){window.addEventListener('message',t);p('SC_CANCEL');function t(u){var v=u.origin,w=u.data;if(q(v,w))return;window.removeEventListener('message',t);switch(w.type){case 'SC_CANCELLED':r(k);break;default:s(l);}}});}function p(r){window.postMessage({recipient:c('FBRTCScreenSharingUtils').RECIPIENT,text:'communicate with screen sharing extension',type:r},'*');}function q(r,s){if(!(s instanceof Object))return true;var t=s.recipient,u=s.type;if(r!==window.location.origin||!(t&&t==='SC_DOM')||!u)return true;return false;}f.exports=m;}),null);